import{r as m,_ as _e,l as t,V as Ae,W as _,a7 as Me,aW as Oe,j as e,aF as T,aX as oe,aY as de,aZ as He,a_ as ze,a$ as qe,b0 as o,aV as Ue,a8 as we,an as We,az as Le,aB as Ke,b1 as Xe,b2 as Ze,aq as V}from"./main.js";import{u as xe,a as pe,g as Ye,c as Ee,A as Ve,T as ke}from"./main-499a499e.js";import{A as Re}from"./AdminTheme-95628d10.js";import{u as $e,a as ce,D as Je,c as Qe,S as es,b as ss,I as Pe,P as G,d as ts,T as is,M as ns,e as ls,f as as,C as g,g as k,h as rs}from"./ThemeSettings-1394036c.js";import{A as v,a as F,T as D,b as U,R as os,B as ds,c as cs,S as Ge}from"./settings-d6f535d3.js";import{C as us}from"./ComputedFieldTypeEnum-9a013b11.js";import{e as w,B as ms,M as ps,w as gs,x as xs,y as fs,z as hs,A as js,j as bs}from"./index.esm-d52ea482.js";import{h as Cs,i as Ss,e as ys,f as Ts,g as vs}from"./index.esm-31eaeb1f.js";import{C as Be}from"./ConfirmDialog-a562852d.js";import{E as ue}from"./EnumTypeEnum-7ffcf33a.js";import{B as p}from"./Box-0ce68545.js";import{I as A,T as Fs}from"./iconBase-acf0401f.js";import{F as me}from"./FormControl-e1c831f9.js";import{F as h}from"./Select-07b752e9.js";import{a as Us,S as ws}from"./Switch-321ceb1c.js";import{F as M}from"./FormHelperText-ab957a1c.js";import{R as ge}from"./RadioGroup-330d4c57.js";import{R as y}from"./Radio-f4e05e00.js";import{T as R}from"./TextField-c8735bb7.js";import{B as P}from"./Button-53dec484.js";import{j as Ls,h as Es}from"./Actions-eda228ad.js";import{F as ee}from"./FormControlLabel-8e3c3f60.js";import{C as De,a as Vs}from"./CardContent-c5e4b8be.js";import"./identifier-91e83c3b.js";import"./Paper-1943bcb2.js";import"./index-ad1f025d.js";import"./Collapse-746eff24.js";import"./Input-29494a31.js";import"./useFormControl-74340145.js";import"./utils-a4c617b5.js";import"./DialogContent-93dc71be.js";import"./createSvgIcon-92c7fe83.js";import"./Close-07cb3d3a.js";m.lazy(()=>_e(()=>import("./ComputedFieldMore-6dc2745e.js"),["./ComputedFieldMore-6dc2745e.js","./main.js","./index.esm-d52ea482.js","./identifier-91e83c3b.js","./iconBase-acf0401f.js","./Box-0ce68545.js","./ConfirmDialog-a562852d.js","./DialogContent-93dc71be.js","./createSvgIcon-92c7fe83.js","./Select-07b752e9.js","./useFormControl-74340145.js","./utils-a4c617b5.js","./main-499a499e.js","./Paper-1943bcb2.js","./main-9fe7f77b.css","./Input-29494a31.js","./Switch-321ceb1c.js","./Close-07cb3d3a.js","./FormControlLabel-8e3c3f60.js","./Button-53dec484.js","./index.esm-31eaeb1f.js","./MenuItem-15f494c0.js"],import.meta.url));const ks=({appId:r,setIsUpdated:b,setComputeFieldOpen:l,setHasErrors:i})=>{t.debug(r);const x=xe(),K=$e(ce(ls),ce(ns),ce(is)),C=Ae(_.getState(),r);t.debug("metaData",C);const O={label:"",type:us.TEXT,expression:""},[se,H]=m.useState(-1),[B,z]=m.useState(O),[X,Z]=m.useState(!1),[te,Y]=m.useState(!1),[$,ie]=m.useState(),[q,ne]=m.useState(!1);t.debug(se,B),m.useEffect(()=>{l(X)},[X,l]);const S=pe(c=>Me(c,r));t.debug("formSettings",S);const n=pe(c=>Oe(c,r));t.debug("columns",n);const I=n.map(c=>c.columnName);t.debug("sortableColumns",I);const le=(c,s)=>{t.debug(c,s),x(He({appId:r,index:c,visible:s})),b(!0)},N=(c,s)=>{t.debug(c,s),x(ze({appId:r,index:c,updatable:s})),b(!0)},W=c=>{const{active:s,over:u}=c;(s==null?void 0:s.id)!==(u==null?void 0:u.id)&&t.debug(s,u)},J=c=>{c!==void 0&&(x(qe({appId:r,index:c})),H(-1),z(O),Z(!1),b(!0))},Q=c=>{const s=[];for(let u=1;u<=c;u++)s.push({value:u,label:u});return s},j=()=>null,d=(c,s,u)=>e.jsxs(e.Fragment,{children:[e.jsx(p,{sx:{"& svg":{visibility:"visible",pointerEvents:"none",opacity:"0.5"}},children:e.jsx(as,{id:c,enabled:!1})}),e.jsxs(p,{sx:{display:"inline-grid",gridTemplateColumns:n[u].computedField!==void 0?"auto auto":"auto",justifyContent:"start",alignItems:"center",gap:"10px","& svg":{opacity:"0.5"}},children:[n[u].computedField!==void 0&&e.jsx(vs,{}),e.jsx(h,{children:s})]})]});return e.jsxs(Je,{autoScroll:!0,sensors:K,collisionDetection:Qe,onDragEnd:W,children:[e.jsxs(es,{items:I,children:[I.map((c,s)=>{var he,je,be,Ce,Se,ye,Te,ve,Fe;const u=c,ae=n[s].computedField!==void 0,Ie=n[s].computedField?((he=n[s].computedField)==null?void 0:he.label)===""?"<No Label>":((je=n[s].computedField)==null?void 0:je.label)??u:n[s].columnLabel??u,f=Ye(C,u),L=f!==void 0?C.columns[f]:null,re=f!==void 0?C.columns[f].data_type:"",Ne=f!==void 0?C.columns[f].column_type:"",fe=f!==void 0?Ee(C.columns[f].data_type):"";return e.jsx(ss,{id:u,children:e.jsxs(v,{disableGutters:!0,children:[e.jsxs(F,{className:"pp-column-settings",expandIcon:e.jsx(w,{}),sx:{justifyContent:"space-between"},children:[e.jsx(p,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",alignItems:"center","& svg":{display:"flex"}},children:d(u,Ie,s)}),e.jsxs(p,{style:{display:"grid",gridTemplateColumns:"40px 40px 40px"},children:[e.jsx(D,{title:"Visible",position:"bottom",children:e.jsx(A,{onClick:a=>{var E;le(s,!((E=n[s])!=null&&E.visible)),a.stopPropagation()},children:e.jsx(Pe,{checked:(be=n[s])==null?void 0:be.visible,children:e.jsx(ms,{})})})}),ae?e.jsx(e.Fragment,{children:e.jsx(D,{title:"Delete",position:"bottom",children:e.jsx(A,{onClick:a=>{Y(!0),ie(s),a.stopPropagation()},children:e.jsx(gs,{})})})}):e.jsx(D,{title:"Updatable",position:"bottom",children:e.jsx(A,{onClick:a=>{var E;N(s,!((E=n[s])!=null&&E.updatable)),a.stopPropagation()},children:e.jsx(Pe,{checked:(Ce=n[s])==null?void 0:Ce.updatable,children:e.jsx(ps,{})})})}),e.jsx(D,{title:"Alignment",position:"bottom",children:e.jsxs(A,{onClick:a=>{n[s].alignment===T.LEFT?x(oe({appId:r,index:s,alignment:T.CENTER})):n[s].alignment===T.CENTER?x(oe({appId:r,index:s,alignment:T.RIGHT})):n[s].alignment===T.RIGHT&&x(oe({appId:r,index:s,alignment:T.LEFT})),b(!0),a.stopPropagation()},children:[n[s].alignment===T.LEFT&&e.jsx(xs,{}),n[s].alignment===T.CENTER&&e.jsx(fs,{}),n[s].alignment===T.RIGHT&&e.jsx(hs,{})]})})]})]}),e.jsx(U,{children:e.jsxs(p,{children:[e.jsxs(v,{disableGutters:!0,children:[e.jsxs(F,{expandIcon:e.jsx(w,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Cs,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Grid positioning"})]}),e.jsxs(U,{sx:{paddingTop:"0.5rem"},children:[e.jsxs(p,{children:[e.jsxs(me,{sx:{display:"grid"},children:[e.jsx(h,{children:"Grid cells"}),e.jsx(Us,{value:(Se=n[s])==null?void 0:Se.cells,min:1,max:S.cellsPerRow,step:1,marks:Q(S.cellsPerRow),valueLabelDisplay:"off",disabled:!0,onChange:(a,E)=>{b(!0),t.debug(a,E)},sx:{width:"calc(100% - 40px)",margin:"20px"}})]}),e.jsx(M,{children:"Number of grid cells used (can be changed in FORM > Grid)"}),e.jsxs(me,{sx:{width:"100%"},children:[e.jsx(h,{sx:{margin:"15px 0 5px 0"},children:"Grid positioning"}),e.jsx(ge,{sx:{flexDirection:"column",alignContent:"flex-start",marginLeft:"10px",marginBottom:"5px"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",justifyContent:"center",alignItems:"center"},children:[e.jsxs(h,{className:"align-label-radio",children:[e.jsx(y,{checked:((ye=n[s])==null?void 0:ye.cellClass)===de.AUTO,disabled:!0,onChange:a=>{a.stopPropagation()}}),"Auto"]}),e.jsxs(h,{className:"align-label-radio",children:[e.jsx(y,{checked:((Te=n[s])==null?void 0:Te.cellClass)===de.START,disabled:!0,onChange:a=>{a.stopPropagation()}}),"Start"]}),e.jsxs(h,{className:"align-label-radio",children:[e.jsx(y,{checked:((ve=n[s])==null?void 0:ve.cellClass)===de.END,disabled:!0,onChange:a=>{a.stopPropagation()}}),"End"]}),e.jsxs(h,{children:[e.jsx(y,{checked:typeof((Fe=n[s])==null?void 0:Fe.cellClass)=="number",disabled:!0,onChange:a=>{a.stopPropagation()}}),"Add"]}),e.jsxs("div",{style:{marginLeft:"10px",gridColumn:"span 2",display:"grid",gridTemplateColumns:"auto auto",alignItems:"center"},children:[e.jsx(R,{id:"pp-cells-before",sx:{width:"60px"},className:"pp-cells-before",type:"number",defaultValue:1,InputProps:{inputProps:{min:1,max:S.cellsPerRow-1}},disabled:!0,InputLabelProps:{shrink:!0},onChange:a=>{a.stopPropagation()}}),e.jsx(h,{sx:{marginLeft:"10px"},children:"cell(s) before"})]})]})})]}),e.jsx(M,{children:"Grid positioning relative to surrounding cells"}),!ae&&f!==void 0&&C.columns[f].data_type==="enum"&&e.jsxs(p,{sx:{marginTop:"20px"},children:[e.jsx(h,{children:"Show values in"}),e.jsxs(ge,{sx:{flexDirection:"column",alignContent:"flex-start",margin:"10px 0 5px 10px"},children:[e.jsxs(h,{className:"align-label-radio",children:[e.jsx(y,{checked:n[s].updatableEnum===void 0||n[s].updatableEnum===ue.LIST,disabled:!0,onChange:a=>{a.stopPropagation()}}),"Drop-down List"]}),e.jsxs(h,{className:"align-label-radio",children:[e.jsx(y,{checked:n[s].updatableEnum===ue.RADIO_HORIZONTAL,disabled:!0,onChange:a=>{a.stopPropagation()}}),"Horizontal radio group"]}),e.jsxs(h,{className:"align-label-radio",children:[e.jsx(y,{checked:n[s].updatableEnum===ue.RADIO_VERTICAL,disabled:!0,onChange:a=>{a.stopPropagation()}}),"Vertical radio group"]})]})]})]}),e.jsx(G,{single:!1})]})]}),!ae&&f!==void 0&&Ee(C.columns[f].data_type)==="number"&&e.jsxs(v,{disableGutters:!0,children:[e.jsxs(F,{expandIcon:e.jsx(w,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Ss,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Validation"})]}),e.jsxs(U,{sx:{paddingTop:"1rem"},children:[e.jsxs(me,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx(R,{error:q,type:"number",label:"Minimum value allowed",disabled:!0,value:n[s].numericMin??"",required:!1,InputLabelProps:{shrink:!0},onChange:a=>{t.debug(a)}}),e.jsx(R,{error:q,type:"number",label:"Maximum value allowed",disabled:!0,value:n[s].numericMax??"",required:!1,InputLabelProps:{shrink:!0},onChange:a=>{t.debug(a)}})]}),e.jsx(G,{})]})]}),e.jsxs(v,{disableGutters:!0,children:[e.jsxs(F,{expandIcon:e.jsx(w,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(ys,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column settings"})]}),e.jsxs(U,{sx:{display:"grid",gridGap:"2rem",paddingTop:"1rem"},children:[e.jsxs(p,{children:[e.jsx(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:(!re.toLowerCase().includes("text")&&!re.toLowerCase().includes("enum")&&!re.toLowerCase().includes("set")&&!Ne.toLowerCase().includes("tinyint(1)")&&(fe.toLowerCase().includes("string")||fe.toLowerCase().includes("number"))||n[s].computedField)&&e.jsxs(e.Fragment,{children:[e.jsx(R,{type:"text",variant:"outlined",label:"Prefix",value:n[s].prefix,disabled:!0,InputLabelProps:{shrink:!0},onChange:a=>{t.debug(a)}}),e.jsx(R,{type:"text",variant:"outlined",label:"Suffix",value:n[s].suffix,disabled:!0,InputLabelProps:{shrink:!0},onChange:a=>{t.debug(a)}})]})}),e.jsx(M,{children:"Adds a prefix and/or suffix to the column content"})]}),e.jsxs(p,{children:[e.jsx(R,{type:"text",variant:"outlined",label:"CSS classes",fullWidth:!0,value:n[s].classNames,disabled:!0,InputLabelProps:{shrink:!0},onChange:a=>{t.debug(a)}}),e.jsx(M,{children:"CSS classes (seperated by spaces) for custom styling"})]}),e.jsx(G,{single:!1,margin:"0"})]})]}),L!==null&&e.jsxs(v,{disableGutters:!0,children:[e.jsxs(F,{expandIcon:e.jsx(w,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(Ts,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column meta data"})]}),e.jsx(U,{sx:{display:"grid"},children:e.jsxs(p,{sx:{marginTop:"1rem",display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"left",alignItems:"center"},children:[e.jsx("div",{children:"Column name"}),e.jsx("div",{children:e.jsx("strong",{children:L.column_name})}),e.jsx("div",{children:"Data type"}),e.jsx("div",{children:e.jsx("strong",{children:L.column_type})}),e.jsx("div",{children:"Is nullable"}),e.jsx("div",{children:e.jsx("strong",{children:L.is_nullable})}),e.jsx("div",{children:"Default value"}),e.jsx("div",{children:e.jsx("strong",{children:L.column_default??"null"})}),L.extra!==""&&e.jsxs(e.Fragment,{children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("strong",{children:L.extra})})]})]})})]})]})})]},s)},s)}),e.jsx(ts,{})]}),e.jsx(p,{sx:{padding:"15px 15px 25px 5px",marginBottom:"5px",textAlign:"right"},children:e.jsx(P,{variant:"contained",startIcon:e.jsx(js,{}),disabled:!0,onClick:()=>{H(-1),z(O),Z(!0)},children:"Computed Field"})}),j(),e.jsx(Be,{title:"Delete computed field?",message:"Are you sure you want to delete this computed field? This action cannot be undone!",open:te,setOpen:Y,onConfirm:()=>J($)})]})},Rs=({appId:r,setIsUpdated:b})=>{t.debug(r),xe();const l=pe(i=>Me(i,r));return t.debug("formSettings",l),e.jsxs(e.Fragment,{children:[e.jsxs(v,{defaultExpanded:!0,disableGutters:!0,children:[e.jsx(F,{expandIcon:e.jsx(w,{}),children:"Field layout"}),e.jsxs(U,{sx:{display:"grid"},children:[e.jsxs(ge,{value:l.fieldVariant,sx:{flexDirection:"row"},onChange:i=>{t.debug(i)},children:[e.jsx(ee,{control:e.jsx(y,{disabled:!0}),value:"outlined",label:"Outlined"},"outlined"),e.jsx(ee,{control:e.jsx(y,{disabled:!0}),value:"filled",label:"Filled"},"filled"),e.jsx(ee,{control:e.jsx(y,{disabled:!0}),value:"standard",label:"Standard"},"standard")]}),e.jsx(M,{children:"Applies to data entry forms only"}),e.jsx(G,{})]})]}),e.jsxs(v,{defaultExpanded:!1,disableGutters:!0,children:[e.jsx(F,{expandIcon:e.jsx(w,{}),children:"Grid"}),e.jsxs(U,{sx:{display:"grid",gridTemplateColumns:"repeat(1, 1fr)",gap:"20px",marginTop:"5px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[e.jsx(R,{type:"number",label:"Cells per row",value:l.cellsPerRow,disabled:!0,InputLabelProps:{shrink:!0},onChange:i=>{t.debug(i)}}),e.jsx(g,{label:"Space between cells",textField:{cssValue:l.spacing.betweenCells,cssUnit:l.spacing.betweenCellsUnit},defaultValue:{cssValue:o.betweenCells,cssUnit:o.betweenCellsUnit},updateSettings:i=>{t.debug(i)}})]}),e.jsx(ee,{control:e.jsx(ws,{disabled:!0,checked:l.showGrid,onChange:(i,x)=>{t.debug(i,x)}}),label:"Show grid"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginTop:"10px"},children:[e.jsx(g,{label:"Padding top",textField:{cssValue:l.spacing.aroundGridTop,cssUnit:l.spacing.aroundGridTopUnit},defaultValue:{cssValue:o.aroundGridTop,cssUnit:o.aroundGridTopUnit},updateSettings:i=>{t.debug(i)}}),e.jsx(g,{label:"Padding bottom",textField:{cssValue:l.spacing.aroundGridBottom,cssUnit:l.spacing.aroundGridBottomUnit},defaultValue:{cssValue:o.aroundGridBottom,cssUnit:o.aroundGridBottomUnit},updateSettings:i=>{t.debug(i)}}),e.jsx(g,{label:"Padding left",textField:{cssValue:l.spacing.aroundGridLeft,cssUnit:l.spacing.aroundGridLeftUnit},defaultValue:{cssValue:o.aroundGridLeft,cssUnit:o.aroundGridLeftUnit},updateSettings:i=>{t.debug(i)}}),e.jsx(g,{label:"Padding right",textField:{cssValue:l.spacing.aroundGridRight,cssUnit:l.spacing.aroundGridRightUnit},defaultValue:{cssValue:o.aroundGridRight,cssUnit:o.aroundGridRightUnit},updateSettings:i=>{t.debug(i)}})]}),e.jsx(G,{single:!1})]})]}),e.jsxs(v,{defaultExpanded:!1,disableGutters:!0,children:[e.jsx(F,{expandIcon:e.jsx(w,{}),children:"Cells"}),e.jsxs(U,{style:{display:"grid",gridTemplateColumns:"repeat(1, 1fr)"},children:[e.jsxs(p,{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginTop:"5px"},children:[e.jsx(g,{label:"Padding top",textField:{cssValue:l.spacing.cellTop,cssUnit:l.spacing.cellTopUnit},defaultValue:{cssValue:o.cellTop,cssUnit:o.cellTopUnit},updateSettings:i=>{t.debug(i)}}),e.jsx(g,{label:"Padding bottom",textField:{cssValue:l.spacing.cellBottom,cssUnit:l.spacing.cellBottomUnit},defaultValue:{cssValue:o.cellBottom,cssUnit:o.cellBottomUnit},updateSettings:i=>{t.debug(i)}}),e.jsx(g,{label:"Padding left",textField:{cssValue:l.spacing.cellLeft,cssUnit:l.spacing.cellLeftUnit},defaultValue:{cssValue:o.cellLeft,cssUnit:o.cellLeftUnit},updateSettings:i=>{t.debug(i)}}),e.jsx(g,{label:"Padding right",textField:{cssValue:l.spacing.cellRight,cssUnit:l.spacing.cellRightUnit},defaultValue:{cssValue:o.cellRight,cssUnit:o.cellRightUnit},updateSettings:i=>{t.debug(i)}})]}),e.jsx(M,{sx:{marginTop:"20px"},children:"Spacing around cells"}),e.jsx(G,{single:!1})]})]}),e.jsxs(v,{defaultExpanded:!1,disableGutters:!0,children:[e.jsx(F,{expandIcon:e.jsx(w,{}),children:"Field spacing"}),e.jsxs(U,{sx:{display:"grid"},children:[e.jsxs(p,{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginTop:"5px"},children:[e.jsx(g,{label:"Padding top",textField:{cssValue:l.spacing.fieldTop,cssUnit:l.spacing.fieldTopUnit},defaultValue:{cssValue:o.fieldTop,cssUnit:o.fieldTopUnit},updateSettings:i=>{t.debug(i)}}),e.jsx(g,{label:"Padding bottom",textField:{cssValue:l.spacing.fieldBottom,cssUnit:l.spacing.fieldBottomUnit},defaultValue:{cssValue:o.fieldBottom,cssUnit:o.fieldBottomUnit},updateSettings:i=>{t.debug(i)}}),e.jsx(g,{label:"Padding left",textField:{cssValue:l.spacing.fieldLeft,cssUnit:l.spacing.fieldLeftUnit},defaultValue:{cssValue:o.fieldLeft,cssUnit:o.fieldLeftUnit},updateSettings:i=>{t.debug(i)}}),e.jsx(g,{label:"Padding right",textField:{cssValue:l.spacing.fieldRight,cssUnit:l.spacing.fieldRightUnit},defaultValue:{cssValue:o.fieldRight,cssUnit:o.fieldRightUnit},updateSettings:i=>{t.debug(i)}})]}),e.jsx(M,{sx:{marginTop:"20px"},children:"Spacing within data entry fields"}),e.jsx(G,{single:!1})]})]})]})},mt=({appId:r})=>{var J,Q;t.debug(r);const b=xe(),l=Ae(_.getState(),r),i=l.src.dbs,x=l.src.tbl;t.debug("metaData",l,i,x);const[K,C]=m.useState(Ue(_.getState(),r));t.debug(K);const[O,se]=m.useState(we(_.getState(),r));t.debug(O);const[H,B]=m.useState(!1),[z,X]=m.useState(!1),[Z,te]=m.useState(!1),[Y,$]=m.useState(!1),ie=((J=Re)==null?void 0:J.palette.mode)===We.LIGHT?(Q=Re)==null?void 0:Q.palette.primary.main:"",q=j=>{b(Ke({anchor:j}))},ne=()=>{b(Xe({appId:r,formState:K}))},S=()=>{b(Ze({}))},n=()=>{H?$(!0):(ne(),S())},I=()=>{if(z)V("Please save or cancel compute field to save",{variant:"error"});else if(Z)V("Column settings contains errors",{variant:"error"});else{let j=!1;Ls(r,Ge.GLOBAL,i,x,d=>{if(t.debug(d),d!=null&&d.code&&(d!=null&&d.message))switch(d.code){case"ok":V(d.message,{variant:"success"});break;case"error":V(d.message,{variant:"error"}),j=!0;break;default:V(d.message,{variant:"info"})}else t.error(d),V("Invalid response - check console for more information",{variant:"error"}),j=!0}),j||C(Ue(_.getState(),r)),j=!1,Es(r,Ge.GLOBAL,i,x,d=>{t.debug(d),d!=null&&d.code&&(d!=null&&d.message)?d.code==="error"&&(j=!0):(t.error(d),V("Invalid response - check console for more information",{variant:"error"}),j=!0)}),j||se(we(_.getState(),r)),B(!1)}},le=()=>{H&&!z?(I(),setTimeout(()=>{S()},1e3)):S()},[N,W]=m.useState(k.FORM);return t.debug(N),e.jsxs(e.Fragment,{children:[e.jsxs(os,{closeDrawer:n,children:[e.jsx(Ve,{position:"static",sx:{borderRadius:0},children:e.jsxs(ke,{className:"pp-setting-toolbar",sx:{borderRadius:0},children:[e.jsx(Fs,{variant:"h5",noWrap:!0,component:"div",className:"unselectable",sx:{flexGrow:1,display:{xs:"none",sm:"block"},paddingLeft:"6px"},children:"Form Builder"}),e.jsx(D,{title:"Dock to left",position:"bottom",children:e.jsx(A,{onClick:()=>{q(Le.LEFT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(ds,{})})}),e.jsx(D,{title:"Dock to right",position:"bottom",children:e.jsx(A,{onClick:()=>{q(Le.RIGHT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(cs,{})})}),e.jsx(D,{title:"Close",position:"bottom",children:e.jsx(A,{onClick:n,size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(bs,{})})})]})}),e.jsx(Ve,{position:"static",className:"pp-setting-buttons-appbar",sx:{borderRadius:0},children:e.jsxs(ke,{className:"pp-setting-buttons pp-settings-buttons-dataform",children:[e.jsx(P,{variant:"text",onClick:()=>{W(k.FORM)},children:"Form"}),e.jsx(P,{variant:"text",onClick:()=>{W(k.COLUMNS)},children:"Columns"}),e.jsx(P,{variant:"text",onClick:()=>{W(k.THEME)},children:"Theme"})]})}),e.jsxs(De,{className:"pp-settings-container",children:[N===k.FORM&&e.jsx(Rs,{appId:r,setIsUpdated:B}),N===k.COLUMNS&&e.jsx(ks,{appId:r,setIsUpdated:B,setComputeFieldOpen:X,setHasErrors:te}),N===k.THEME&&e.jsx(rs,{appId:r,setIsUpdated:B})]}),e.jsx(De,{className:"pp-setting-footer",sx:{borderRadius:0,backgroundColor:ie},children:e.jsxs(Vs,{className:"pp-setting-footer-buttons",sx:{borderRadius:0},children:[e.jsx(P,{variant:"outlined",className:"footer_action_button_apply",onClick:I,children:"Apply"}),e.jsx(P,{variant:"outlined",className:"footer_action_button",onClick:le,children:"OK"}),e.jsx(P,{variant:"outlined",className:"footer_action_button",onClick:n,children:"Cancel"})]})})]}),e.jsx(Be,{title:"Close Form Builder?",message:"All uncommitted changes will be lost!",open:Y,setOpen:$,onConfirm:()=>{ne(),S()},onKeep:()=>{S()}})]})};export{mt as default};
