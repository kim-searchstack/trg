import{l as a,V as Ce,W as se,a6 as Oe,aD as Be,j as e,aI as pe,aG as me,aJ as re,aK as N,aL as Ie,r as f,aF as R,aM as Ne,aN as Ge,aO as Ue,aP as Ve,aQ as ze,aR as He,aS as ye,a8 as we,an as _e,az as Se,aB as qe,aT as We,aU as Qe,aq as Z}from"./main.js";import{u as ve,a as fe,i as L,g as Ke,c as Pe,A as Ae,T as Fe}from"./main-499a499e.js";import{g as Je,h as Xe}from"./Actions-eda228ad.js";import{e as y,s as Ye,h as Ze,t as $e,v as es,w as ss,x as ns,y as is,z as ls,A as ts,j as os}from"./index.esm-d52ea482.js";import"./vi-589d0887.js";import{P as ue,C as xe,u as as,a as ge,D as rs,c as cs,S as ds,b as us,I as je,d as ps,T as ms,M as xs,e as hs,f as gs,g as $,h as js}from"./ThemeSettings-1394036c.js";import{A as w,a as S,b as P,T,R as bs,B as fs,c as Cs,S as Le}from"./settings-d6f535d3.js";import{F as g}from"./FormControl-e1c831f9.js";import{R as de}from"./RadioGroup-330d4c57.js";import{F as c}from"./FormControlLabel-8e3c3f60.js";import{R as v}from"./Radio-f4e05e00.js";import{F as j}from"./FormHelperText-ab957a1c.js";import{A as vs,S as x,a as De}from"./Switch-321ceb1c.js";import{T as ce}from"./TextField-c8735bb7.js";import{B as m}from"./Box-0ce68545.js";import{C as Es}from"./ComputedFieldTypeEnum-9a013b11.js";import{C as Me}from"./ConfirmDialog-a562852d.js";import{e as ks,f as ys,g as ws}from"./index.esm-31eaeb1f.js";import{I as B,T as Ss}from"./iconBase-acf0401f.js";import{F as be}from"./Select-07b752e9.js";import{B as ee}from"./Button-53dec484.js";import{A as Re}from"./AdminTheme-95628d10.js";import{C as Te,a as Ps}from"./CardContent-c5e4b8be.js";import"./identifier-91e83c3b.js";import"./Paper-1943bcb2.js";import"./index-ad1f025d.js";import"./Collapse-746eff24.js";import"./Input-29494a31.js";import"./useFormControl-74340145.js";import"./utils-a4c617b5.js";import"./createSvgIcon-92c7fe83.js";import"./Close-07cb3d3a.js";import"./DialogContent-93dc71be.js";const As=({appId:d,setIsUpdated:C})=>{var D,z,H,ne,ie,_,q,le,O,te,A,t,W,oe,I,F,Q,K,b,u;a.debug(d);const M=ve(),p=Ce(se.getState(),d);a.debug("metaData",p);const s=fe(n=>Oe(n,d));a.debug("storeTableSettings",s);const G=fe(n=>Be(n,d));a.debug("columnsStore",G);const E=G.filter(n=>n.computedField!==void 0);a.debug("storeColumnSettings",E);const U=(n,l,J)=>{const[o,...i]=l.split(".");return{...n,[o]:i.length?U(n[o],i.join("."),J):J}},h=(n,l)=>{a.debug(n,l);const J=U(s,n,l);a.debug(J),M(Ie({appId:d,tableSettings:J})),C(!0)};let V=[{language:"English US",code:"en-US",dayjs:"en"}];return e.jsxs(e.Fragment,{children:[e.jsxs(w,{sx:{display:"none"},disableGutters:!0,children:[e.jsx(S,{expandIcon:e.jsx(y,{}),children:"Processing"}),e.jsxs(P,{children:[e.jsx(g,{children:e.jsxs(de,{sx:{flexDirection:"row"},children:[e.jsx(c,{control:e.jsx(v,{checked:(s==null?void 0:s.processing)===pe.SERVERSIDE,onChange:n=>{h("processing",pe.SERVERSIDE),n.stopPropagation()}}),value:"serverside",label:"Server-side"},"serverside"),e.jsx(c,{control:e.jsx(v,{checked:(s==null?void 0:s.processing)===pe.CLIENTSIDE,onChange:n=>{h("processing",pe.CLIENTSIDE),n.stopPropagation()}}),value:"clientside",label:"Client-side"},"clientside")]})}),e.jsx(j,{children:"Use server-side for large tables and views, use client-side for quick analyses of small tables and views"})]})]}),e.jsxs(w,{disableGutters:!0,defaultExpanded:!1,children:[e.jsx(S,{expandIcon:e.jsx(y,{}),children:"Responsiveness"}),e.jsxs(P,{children:[e.jsx(g,{children:e.jsxs(de,{sx:{flexDirection:"row"},children:[e.jsx(c,{control:e.jsx(v,{checked:((D=s==null?void 0:s.design)==null?void 0:D.overflow)===me.RESPONSIVE,onChange:n=>{h("design.overflow",me.RESPONSIVE),n.stopPropagation()}}),value:"responsive",label:"Auto column hiding"},"responsive"),e.jsx(c,{control:e.jsx(v,{checked:((z=s==null?void 0:s.design)==null?void 0:z.overflow)!==me.RESPONSIVE,onChange:n=>{h("design.overflow",me.SCROLL),n.stopPropagation()}}),value:"scroll",label:"Horizontal scrollbar"},"scroll")]})}),e.jsx(j,{children:"Behaviour when table content overflows available space"})]})]}),e.jsxs(w,{disableGutters:!0,children:[e.jsx(S,{expandIcon:e.jsx(y,{}),children:"Language"}),e.jsxs(P,{children:[e.jsx(g,{fullWidth:!0,children:e.jsx(vs,{multiple:!1,fullWidth:!0,disablePortal:!0,options:V,disabled:!0,getOptionLabel:n=>n.language,value:s!=null&&s.locale?V.filter(n=>n.code===(s==null?void 0:s.locale))[0]:null,onChange:(n,l)=>{h("locale",(l==null?void 0:l.code)??"")},renderInput:n=>e.jsx(ce,{...n})})}),e.jsx(ue,{})]})]}),e.jsxs(w,{disableGutters:!0,children:[e.jsx(S,{expandIcon:e.jsx(y,{}),children:"Row actions"}),e.jsx(P,{children:e.jsxs(m,{sx:{display:"grid"},children:[e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{disabled:!((H=p==null?void 0:p.privs)!=null&&H.insert),checked:(ne=s==null?void 0:s.transactions)==null?void 0:ne.insert,onChange:(n,l)=>{h("transactions.insert",l),n.stopPropagation()}}),label:"Allow insert"})}),e.jsx(j,{children:"Adds an insert button to the table toolbar"}),e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{checked:s==null?void 0:s.viewLink,onChange:(n,l)=>{h("viewLink",l),n.stopPropagation()}}),label:"Allow viewing"})}),e.jsx(j,{children:"Adds a view icon to each row"}),e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{checked:(ie=s==null?void 0:s.transactions)==null?void 0:ie.update,disabled:!((_=p==null?void 0:p.privs)!=null&&_.update),onChange:(n,l)=>{h("transactions.update",l),n.stopPropagation()}}),label:"Allow update"})}),e.jsx(j,{children:"Adds an update icon to each table row"}),e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{checked:(q=s==null?void 0:s.transactions)==null?void 0:q.delete,disabled:!((le=p==null?void 0:p.privs)!=null&&le.delete),onChange:(n,l)=>{h("transactions.delete",l),n.stopPropagation()}}),label:"Allow delete"})}),e.jsx(j,{children:"Adds a delete icon to each table row"})]})})]}),e.jsxs(w,{disableGutters:!0,children:[e.jsx(S,{expandIcon:e.jsx(y,{}),children:"Bulk actions"}),e.jsxs(P,{children:[e.jsxs(m,{sx:{display:"grid"},children:[e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{checked:!1,disabled:!0,onChange:(n,l)=>{a.debug(l),n.stopPropagation()}}),label:"Export to PDF (premium feature)"})}),e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{checked:!L(p)&&((O=s==null?void 0:s.bulkActions)==null?void 0:O.csv),disabled:L(p),onChange:(n,l)=>{h("bulkActions.csv",l),n.stopPropagation()}}),label:"Export to CSV"})}),e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{checked:!L(p)&&((te=s==null?void 0:s.bulkActions)==null?void 0:te.json),disabled:L(p),onChange:(n,l)=>{h("bulkActions.json",l),n.stopPropagation()}}),label:"Export to JSON"})}),e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{checked:!1,disabled:!0,onChange:(n,l)=>{a.debug(l),n.stopPropagation()}}),label:"Export to Excel (premium feature)"})}),e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{checked:!L(p)&&((A=s==null?void 0:s.bulkActions)==null?void 0:A.xml),disabled:L(p),onChange:(n,l)=>{h("bulkActions.xml",l),n.stopPropagation()}}),label:"Export to XML"})}),e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{checked:!L(p)&&((t=s==null?void 0:s.bulkActions)==null?void 0:t.sql),disabled:L(p),onChange:(n,l)=>{h("bulkActions.sql",l),n.stopPropagation()}}),label:"Export to SQL"})}),e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{checked:!L(p)&&((W=s==null?void 0:s.bulkActions)==null?void 0:W.delete),disabled:L(p),onChange:(n,l)=>{h("bulkActions.delete",l),n.stopPropagation()}}),label:"Delete"})})]}),e.jsx(j,{sx:{marginTop:"10px"},children:"Added to menu button"})]})]}),e.jsxs(w,{disableGutters:!0,defaultExpanded:!1,children:[e.jsx(S,{expandIcon:e.jsx(y,{}),children:"Search"}),e.jsxs(P,{children:[e.jsxs(m,{children:[e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{checked:(oe=s==null?void 0:s.searchSettings)==null?void 0:oe.forceSearch,disabled:!0,onChange:(n,l)=>{a.debug(l),n.stopPropagation()}}),label:"Show empty table on startup"})}),e.jsx(j,{sx:{marginTop:"10px",marginBottom:"20px"},children:"Forces user to perform a search"}),e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{checked:(I=s==null?void 0:s.searchSettings)==null?void 0:I.forceInline,disabled:!0,onChange:(n,l)=>{a.debug(l),n.stopPropagation()}}),label:"Show inline search fields on startup"})}),e.jsx(j,{sx:{marginTop:"10px",marginBottom:"20px"},children:"Effective after next page load"}),e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{checked:(F=s==null?void 0:s.searchSettings)==null?void 0:F.forceEnterOnSearch,disabled:!0,onChange:(n,l)=>{a.debug(l),n.stopPropagation()}}),label:"User must press enter key to start search"})}),e.jsx(j,{sx:{marginTop:"10px",marginBottom:"20px"},children:"Reduces network traffic and server load"}),e.jsx(g,{children:e.jsx(c,{control:e.jsx(x,{checked:!((Q=s==null?void 0:s.searchSettings)!=null&&Q.forceEnterOnSearch)&&((K=s==null?void 0:s.searchSettings)==null?void 0:K.highlightMatches),disabled:!0,onChange:(n,l)=>{a.debug(l),n.stopPropagation()}}),label:"Highlight matches"})}),e.jsx(j,{sx:{marginTop:"10px",marginBottom:"20px"},children:"Not available when pressing enter key is required"}),e.jsx(g,{children:e.jsxs(de,{sx:{flexDirection:"row"},children:[e.jsx(c,{control:e.jsx(v,{checked:((b=s==null?void 0:s.searchSettings)==null?void 0:b.estimatedRowCount)===!1,disabled:!0,onChange:n=>{n.stopPropagation()}}),value:"realrowcount",label:"Show real row count"},"realrowcount"),e.jsx(c,{control:e.jsx(v,{checked:((u=s==null?void 0:s.searchSettings)==null?void 0:u.estimatedRowCount)===!0,disabled:!0,onChange:n=>{n.stopPropagation()}}),value:"estimatedrowcount",label:"Show row count estimate"},"estimatedrowcount")]})}),e.jsx(j,{sx:{marginTop:"10px",marginBottom:"20px"},children:"Estimated row count is faster, real row count is more accurate"})]}),e.jsx(ue,{single:!1})]})]}),e.jsxs(w,{disableGutters:!0,defaultExpanded:!1,children:[e.jsx(S,{expandIcon:e.jsx(y,{}),children:"Spacing"}),e.jsxs(P,{children:[e.jsx(g,{children:e.jsxs(de,{sx:{display:"grid",gridTemplateColumns:"auto auto auto",alignItems:"center"},children:[e.jsx(c,{control:e.jsx(v,{checked:(s==null?void 0:s.design.density.default)===re.COMPACT,onChange:n=>{h("design.density.default",re.COMPACT),n.stopPropagation()}}),value:"compact",label:"Compact"},"compact"),e.jsx(c,{control:e.jsx(v,{checked:(s==null?void 0:s.design.density.default)===re.COMFORTABLE,onChange:n=>{h("design.density.default",re.COMFORTABLE),n.stopPropagation()}}),value:"comfortable",label:"Comfortable"},"comfortable"),e.jsx(c,{control:e.jsx(v,{checked:(s==null?void 0:s.design.density.default)===re.SPACIOUS,onChange:n=>{h("design.density.default",re.SPACIOUS),n.stopPropagation()}}),value:"spacious",label:"Spacious"},"spacious")]})}),e.jsx(j,{children:"Default spacing on page load"}),e.jsx(g,{sx:{marginTop:"20px"},children:e.jsx(c,{control:e.jsx(x,{checked:s==null?void 0:s.design.density.userCanChange,onChange:(n,l)=>{h("design.density.userCanChange",l),n.stopPropagation()}}),label:"Allow user to change spacing"})})]})]}),e.jsxs(w,{defaultExpanded:!1,disableGutters:!0,children:[e.jsx(S,{expandIcon:e.jsx(y,{}),children:"Inline fields"}),e.jsxs(P,{sx:{display:"grid"},children:[e.jsxs(de,{value:s.inlineEditing.fieldVariant,sx:{flexDirection:"row"},onChange:n=>{n.stopPropagation()},children:[e.jsx(c,{control:e.jsx(v,{disabled:!0}),value:"outlined",label:"Outlined"},"outlined"),e.jsx(c,{control:e.jsx(v,{disabled:!0}),value:"filled",label:"Filled"},"filled"),e.jsx(c,{control:e.jsx(v,{disabled:!0}),value:"standard",label:"Standard"},"standard")]}),e.jsx(j,{children:"Applies to inline fields only"}),e.jsxs(m,{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginTop:"40px",marginBottom:"10px"},children:[e.jsx(xe,{label:"Padding top",textField:{cssValue:s.inlineEditing.spacing.fieldTop,cssUnit:s.inlineEditing.spacing.fieldTopUnit},defaultValue:{cssValue:N.table.inlineEditing.spacing.fieldTop,cssUnit:N.table.inlineEditing.spacing.fieldTopUnit},updateSettings:n=>{a.debug(n)}}),e.jsx(xe,{label:"Padding bottom",textField:{cssValue:s.inlineEditing.spacing.fieldBottom,cssUnit:s.inlineEditing.spacing.fieldBottomUnit},defaultValue:{cssValue:N.table.inlineEditing.spacing.fieldBottom,cssUnit:N.table.inlineEditing.spacing.fieldBottomUnit},updateSettings:n=>{a.debug(n)}}),e.jsx(xe,{label:"Padding left",textField:{cssValue:s.inlineEditing.spacing.fieldLeft,cssUnit:s.inlineEditing.spacing.fieldLeftUnit},defaultValue:{cssValue:N.table.inlineEditing.spacing.fieldLeft,cssUnit:N.table.inlineEditing.spacing.fieldLeftUnit},updateSettings:n=>{a.debug(n)}}),e.jsx(xe,{label:"Padding right",textField:{cssValue:s.inlineEditing.spacing.fieldRight,cssUnit:s.inlineEditing.spacing.fieldRightUnit},defaultValue:{cssValue:N.table.inlineEditing.spacing.fieldRight,cssUnit:N.table.inlineEditing.spacing.fieldRightUnit},updateSettings:n=>{a.debug(n)}})]}),e.jsx(j,{children:"Space added to inline fields"}),e.jsx(ue,{single:!1})]})]})]})},Fs=({appId:d,setIsUpdated:C,setComputeFieldOpen:M,setHasErrors:p})=>{a.debug(d);const s=ve(),G=as(ge(hs),ge(xs),ge(ms)),E=Ce(se.getState(),d);a.debug("metaData",E);const U={label:"",type:Es.TEXT,expression:""},[h,V]=f.useState(-1),[D,z]=f.useState(U),[H,ne]=f.useState(!1),[ie,_]=f.useState(!1),[q,le]=f.useState(void 0),[O,te]=f.useState(!1);a.debug(h,D),f.useEffect(()=>{M(H)},[H,M]);const A=f.useMemo(()=>{const o=[];for(let i=0;i<E.columns.length;i++)o.push(E.columns[i].column_name);return o.sort((i,k)=>i>k?1:-1),o},[d]);a.debug(A);const t=fe(o=>Be(o,d));a.debug("columns",t);const W=(o,i)=>{a.debug(o,i),s(Ge({appId:d,index:o,visible:i})),C(!0)},oe=(o,i)=>{a.debug(o,i),s(Ue({appId:d,index:o,queryable:i})),C(!0)},I=(o,i)=>{a.debug(o,i),s(Ve({appId:d,index:o,orderable:i})),C(!0)},F=(o,i)=>{s(ze({appId:d,index:o,alignment:i})),C(!0)},Q=o=>{const{active:i,over:k}=o;a.debug(i,k),i==null||i.id,k==null||k.id},K=o=>{o!==void 0&&(s(He({appId:d,index:o})),V(-1),z(U),ne(!1),C(!0))},b=t.map(o=>o.columnName);a.debug("sortableColumns",b);const u=()=>null,n=(o,i,k)=>e.jsxs(e.Fragment,{children:[e.jsx(m,{sx:{"& svg":{visibility:"visible",pointerEvents:"none",opacity:"0.5"}},children:e.jsx(gs,{id:o,enabled:!1})}),e.jsxs(m,{sx:{display:"inline-grid",gridTemplateColumns:t[k].computedField!==void 0?"auto auto":"auto",justifyContent:"start",alignItems:"center",gap:"10px","& svg":{opacity:"0.5"}},children:[t[k].computedField!==void 0&&e.jsx(ws,{}),e.jsx(be,{children:i})]})]}),l=(o,i)=>e.jsxs(e.Fragment,{children:[e.jsx(c,{control:e.jsx(x,{checked:!1,disabled:!0}),label:"Enable inline search",labelPlacement:"end"}),e.jsx(c,{control:e.jsx(x,{checked:!1,disabled:!0}),label:"Enable inline editing",labelPlacement:"end"})]}),J=(o,i)=>null;return e.jsxs(e.Fragment,{children:[e.jsxs(rs,{autoScroll:!0,sensors:G,collisionDetection:cs,onDragEnd:Q,children:[e.jsxs(ds,{items:b,children:[b.map((o,i)=>{var Ee,ke;const k=t[i].computedField?((Ee=t[i].computedField)==null?void 0:Ee.label)===""?"<No Label>":((ke=t[i].computedField)==null?void 0:ke.label)??o:t[i].columnLabel??o,ae=Ke(E,o),X=ae!==void 0?E.columns[ae]:null,Y=ae!==void 0?Pe(E.columns[ae].data_type,!0):"";return e.jsx(us,{id:o,children:e.jsxs(w,{disableGutters:!0,children:[e.jsxs(S,{className:"pp-column-settings",expandIcon:e.jsx(y,{}),sx:{justifyContent:"space-between"},children:[e.jsx(m,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",alignItems:"center","& svg":{display:"flex"}},children:n(o,k,i)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 40px 40px 40px"},children:[e.jsx(T,{title:"Visible",position:"bottom",children:e.jsx(B,{onClick:r=>{W(i,!t[i].visible),r.stopPropagation()},children:e.jsx(je,{checked:t[i].visible,children:e.jsx(Ye,{})})})}),t[i].computedField?e.jsx(T,{title:"Edit",position:"bottom",children:e.jsx(B,{onClick:r=>{r.stopPropagation()},children:e.jsx($e,{})})}):e.jsx(T,{title:"Searchable",position:"bottom",children:e.jsx(B,{onClick:r=>{oe(i,!t[i].queryable),r.stopPropagation()},children:e.jsx(je,{checked:t[i].queryable,alignRight:!1,children:e.jsx(Ze,{})})})}),t[i].computedField?e.jsx(T,{title:"Delete",position:"bottom",children:e.jsx(B,{onClick:r=>{le(i),_(!0),r.stopPropagation()},children:e.jsx(ss,{})})}):e.jsx(T,{title:"Sortable",position:"bottom",children:e.jsx(B,{onClick:r=>{I(i,!t[i].orderable),r.stopPropagation()},children:e.jsx(je,{checked:t[i].orderable,children:e.jsx(es,{})})})}),e.jsx(T,{title:"Alignment",position:"bottom",children:e.jsxs(B,{onClick:r=>{t[i].alignment===R.LEFT?F(i,R.CENTER):t[i].alignment===R.CENTER?F(i,R.RIGHT):t[i].alignment===R.RIGHT&&F(i,R.LEFT),C(!0),r.stopPropagation()},children:[t[i].alignment===R.LEFT&&e.jsx(ns,{}),t[i].alignment===R.CENTER&&e.jsx(is,{}),t[i].alignment===R.RIGHT&&e.jsx(ls,{})]})})]})]}),e.jsxs(P,{children:[e.jsx(m,{sx:{margin:"0 10px",display:"grid",gridTemplateColumns:"auto",alignItems:"center"},children:l()}),e.jsx(ue,{single:!1,margin:"30px"}),e.jsxs(m,{sx:{paddingBottom:"0"},children:[J(),t[i].inlineEditing===!0&&ae!==void 0&&Pe(E.columns[ae].data_type)==="number"&&e.jsxs(g,{sx:{marginTop:"20px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx(ce,{error:O,type:"number",label:"Minimum value allowed",disabled:!0,value:t[i].inlineNumericMin??"",required:!1,InputLabelProps:{shrink:!0},onChange:r=>{a.debug(r)}}),e.jsx(ce,{error:O,type:"number",label:"Maximum value allowed",disabled:!0,value:t[i].inlineNumericMax??"",required:!1,InputLabelProps:{shrink:!0},onChange:r=>{a.debug(r)}})]})]}),e.jsxs(m,{sx:{margin:"2rem 1rem"},children:[e.jsx(be,{children:"Width"}),e.jsxs(m,{sx:{display:"grid",gridTemplateColumns:"1fr auto",gridGap:"30px",alignItems:"center"},children:[e.jsx(De,{min:60,max:420,step:1,value:t[i].width,marks:[{value:60,label:"60"},{value:120,label:"120"},{value:180,label:"180"},{value:240,label:"240"},{value:300,label:"320"},{value:360,label:"360"},{value:420,label:"420"}],valueLabelDisplay:"auto",onChange:(r,he)=>{s(Ne({appId:d,index:i,width:he})),C(!0),r.stopPropagation()}}),e.jsx("span",{children:"px"})]})]}),e.jsxs(m,{children:[e.jsxs(w,{disableGutters:!0,children:[e.jsxs(S,{expandIcon:e.jsx(y,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(ks,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column settings"})]}),e.jsxs(P,{sx:{display:"grid",gridGap:"2rem",paddingTop:"1rem"},children:[e.jsxs(m,{sx:{display:"grid",gridTemplateColumns:"auto"},children:[e.jsx(c,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:r=>{r.stopPropagation()}}),label:"Show column on tablet",labelPlacement:"end"}),e.jsx(c,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:r=>{r.stopPropagation()}}),label:"Show column on mobile",labelPlacement:"end"})]}),(Y==="float"||Y==="number"||t[i].computedField)&&e.jsxs(m,{children:[e.jsx(m,{sx:{display:"block"},children:e.jsx(c,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:r=>{r.stopPropagation()}}),label:"Localize numeric value",labelPlacement:"end"})}),e.jsx(j,{children:"Localizes decimal and thousands seperators (does not affect inline fields)"})]}),(Y==="float"||t[i].computedField)&&e.jsxs(m,{sx:{display:"grid"},children:[e.jsx(be,{children:"Decimals"}),e.jsx(De,{min:0,max:6,value:t[i].decimals,marks:[{value:0,label:"0"},{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"},{value:6,label:"∞"}],valueLabelDisplay:"off",disabled:!0,onChange:(r,he)=>{a.debug(he),r.stopPropagation()}}),e.jsx(j,{children:"Number of decimals displayed (does not affect inline fields)"})]}),(Y==="date"||Y==="datetime")&&e.jsxs(m,{children:[e.jsx(m,{sx:{display:"block"},children:e.jsx(c,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:r=>{r.stopPropagation()}}),label:"Add trailing zeros to days and month",labelPlacement:"end"})}),e.jsx(j,{children:"Localizes decimal and thousands seperators"})]}),(Y==="time"||Y==="datetime")&&e.jsxs(m,{children:[e.jsx(m,{sx:{display:"block"},children:e.jsx(c,{control:e.jsx(x,{checked:!1,disabled:!0,onClick:r=>{r.stopPropagation()}}),label:"Add trailing zeros to hours, minutes and seconds",labelPlacement:"end"})}),e.jsx(j,{children:"Localizes decimal and thousands seperators"})]}),e.jsxs(m,{children:[e.jsxs(m,{sx:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(ce,{type:"text",variant:"outlined",label:"Prefix",value:t[i].prefix,disabled:!0,InputLabelProps:{shrink:!0},onChange:r=>{r.stopPropagation()}}),e.jsx(ce,{type:"text",variant:"outlined",label:"Suffix",value:t[i].suffix,disabled:!0,InputLabelProps:{shrink:!0},onChange:r=>{r.stopPropagation()}})]}),e.jsx(j,{children:"Adds a prefix and/or suffix to the column content (also added to inline text and number fields)"})]}),e.jsxs(m,{children:[e.jsx(ce,{type:"text",variant:"outlined",label:"CSS classes",fullWidth:!0,value:t[i].classNames,disabled:!0,InputLabelProps:{shrink:!0},onChange:r=>{r.stopPropagation()}}),e.jsx(j,{children:"CSS classes (seperated by spaces) for custom styling"})]}),e.jsx(ue,{single:!1,margin:"0"})]})]}),X!==null&&e.jsxs(w,{disableGutters:!0,children:[e.jsxs(S,{expandIcon:e.jsx(y,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(ys,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column meta data"})]}),e.jsx(P,{sx:{display:"grid"},children:e.jsxs(m,{sx:{marginTop:"1rem",display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"left",alignItems:"center"},children:[e.jsx("div",{children:"Column name"}),e.jsx("div",{children:e.jsx("strong",{children:X.column_name})}),e.jsx("div",{children:"Data type"}),e.jsx("div",{children:e.jsx("strong",{children:X.column_type})}),e.jsx("div",{children:"Is nullable"}),e.jsx("div",{children:e.jsx("strong",{children:X.is_nullable})}),e.jsx("div",{children:"Default value"}),e.jsx("div",{children:e.jsx("strong",{children:X.column_default??"null"})}),X.extra!==""&&e.jsxs(e.Fragment,{children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("strong",{children:X.extra})})]})]})})]})]})]})]},i)},o+i)}),e.jsx(ps,{})]}),e.jsx(m,{sx:{padding:"15px 15px 25px 5px",marginBottom:"5px",textAlign:"right"},children:e.jsx(ee,{variant:"contained",startIcon:e.jsx(ts,{}),disabled:!0,onClick:()=>{},children:"Computed Field"})}),u()]}),e.jsx(Me,{title:"Delete computed field?",message:"Are you sure you want to delete this computed field? This action cannot be undone!",open:ie,setOpen:_,onConfirm:()=>K(q)})]})},dn=({appId:d})=>{var Q,K;a.debug(d);const C=ve(),M=Ce(se.getState(),d),p=M.src.dbs,s=M.src.tbl;a.debug("metaData",M,p,s);const[G,E]=f.useState(ye(se.getState(),d));a.debug(G);const[U,h]=f.useState(we(se.getState(),d));a.debug(U);const[V,D]=f.useState(!1),[z,H]=f.useState(!1),[ne,ie]=f.useState(!1),[_,q]=f.useState(!1),le=((Q=Re)==null?void 0:Q.palette.mode)===_e.LIGHT?(K=Re)==null?void 0:K.palette.primary.main:"",O=b=>{C(qe({anchor:b}))},te=()=>{C(We({appId:d,tableState:G}))},A=()=>{C(Qe({}))},t=()=>{V?q(!0):(te(),A())},W=()=>{if(z)Z("Please save or cancel compute field to save",{variant:"error"});else{if(ne)Z("Column settings contains errors",{variant:"error"});else{let b=!1;Je(d,Le.GLOBAL,p,s,u=>{if(u!=null&&u.code&&(u!=null&&u.message))switch(u.code){case"ok":Z(u.message,{variant:"success"});break;case"error":Z(u.message,{variant:"error"}),b=!0;break;default:Z(u.message,{variant:"info"})}else a.error(u),Z("Invalid response - check console for more information",{variant:"error"}),b=!0}),b||E(ye(se.getState(),d)),b=!1,Xe(d,Le.GLOBAL,p,s,u=>{a.debug(u),u!=null&&u.code&&(u!=null&&u.message)?u.code==="error"&&(b=!0):(a.error(u),Z("Invalid response - check console for more information",{variant:"error"}),b=!0)}),b||h(we(se.getState(),d))}D(!1)}},oe=()=>{V&&!z?(W(),setTimeout(()=>{A()},1e3)):A()},[I,F]=f.useState($.TABLE);return e.jsxs(e.Fragment,{children:[e.jsxs(bs,{closeDrawer:t,children:[e.jsx(Ae,{position:"static",sx:{borderRadius:0},children:e.jsxs(Fe,{className:"pp-setting-toolbar",sx:{borderRadius:0},children:[e.jsx(Ss,{variant:"h5",noWrap:!0,component:"div",className:"unselectable",sx:{flexGrow:1,display:{xs:"none",sm:"block"},paddingLeft:"6px"},children:"Table Builder"}),e.jsx(T,{title:"Dock to left",position:"bottom",children:e.jsx(B,{onClick:()=>{O(Se.LEFT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(fs,{})})}),e.jsx(T,{title:"Dock to right",position:"bottom",children:e.jsx(B,{onClick:()=>{O(Se.RIGHT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(Cs,{})})}),e.jsx(T,{title:"Close",position:"bottom",children:e.jsx(B,{onClick:t,size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(os,{})})})]})}),e.jsx(Ae,{position:"static",className:"pp-setting-buttons-appbar",sx:{borderRadius:0},children:e.jsxs(Fe,{className:"pp-setting-buttons pp-settings-buttons-datatables",children:[e.jsx(ee,{variant:"text",onClick:()=>{F($.TABLE)},children:"Table"}),e.jsx(ee,{variant:"text",onClick:()=>{F($.COLUMNS)},children:"Columns"}),e.jsx(ee,{variant:"text",onClick:()=>{F($.THEME)},children:"Theme"})]})}),e.jsxs(Te,{className:"pp-settings-container",children:[I===$.TABLE&&e.jsx(As,{appId:d,setIsUpdated:D}),I===$.COLUMNS&&e.jsx(Fs,{appId:d,setIsUpdated:D,setComputeFieldOpen:H,setHasErrors:ie}),I===$.THEME&&e.jsx(js,{appId:d,setIsUpdated:D})]}),e.jsx(Te,{className:"pp-setting-footer",sx:{borderRadius:0,backgroundColor:le},children:e.jsxs(Ps,{className:"pp-setting-footer-buttons",sx:{borderRadius:0},children:[e.jsx(ee,{variant:"outlined",className:"footer_action_button_apply",onClick:W,children:"Apply"}),e.jsx(ee,{variant:"outlined",className:"footer_action_button",onClick:oe,children:"OK"}),e.jsx(ee,{variant:"outlined",className:"footer_action_button",onClick:t,children:"Cancel"})]})})]}),e.jsx(Me,{title:"Close Table Builder?",message:"All uncommitted changes will be lost!",open:_,setOpen:q,onConfirm:()=>{te(),A()},onKeep:()=>{A()}})]})};export{dn as default};
